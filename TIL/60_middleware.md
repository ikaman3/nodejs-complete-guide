Middleware

                                                 next()
Request -> Middleware (req, res, next) => {...} -------> Middleware (req, res, next) => {...}
-----------> Response ->
res.send()

Express.js는 미들웨어와 깊게 연관되어 있다. 최종적으로 미들웨어의 뜻은 들어오는 요청을 express.js에 의한 다양한 함수를 통해 자동으로 이동하는 것이다. 즉, 단일 요청 핸들러를 보유하는 대신 응답을 전송하기 전까지 요청이 통과하게 될 다양한 함수들을 연결할 가능성을 확보한다.
이를 통해 하나의 함수로 모든 것을 처리하는 것이 아니라 코드를 다수의 블록 내지는 조각들로 분할할 수 있는 것이 Express.js의 특징이다.

미들웨어 기능들을 제공하는 제3자 패키지를 쉽게 Express.js에 추가하여 특정 기능을 추가한다.

app.use()로 전달하는 함수는 3가지 인수를 받는데 요청, 응답, next 이다. next는 사실 함수로, Express.js를 통해 여기로 전달되는 함수이며
이렇게 전달하는 함수는 next 인수에 있는 또 다른 함수를 수신한다. 이 next 인수, 즉 여기에서 수신하는 함수는 다음 미들웨어로 요청이 이동할 수 있도록 실행되어야 한다.

파일의 위에서부터 아래까지 미들웨어를 거치게 되는데, 다음 라인에 있는 미들웨어로 요청을 이동시키려면 next() 를 호출해야 한다. next를 호출하지 않으면 그냥 멈추고 결국 응답을 처리하는 코드에 도달하지 못하게 된다.
=============================================================================================================
send

setHeader, write를 사용해서 기존과 같은 방법으로 응답을 보낼 수 있지만 express에서 제공하는 유틸리티 함수 send를 사용할 수 있다.

res.send('<h1>Hello from Express!!');

Headers에서 Content-Type: text/html로 되어 있음을 볼 수 있다. 자동으로 이루어지며 Express에서 제공한다.
res.setHeader() 를 사용하여 수동으로 설정할 수도 있다.
기본 응답 헤더는 text/html 이다. 